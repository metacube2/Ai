<!DOCTYPE html>
<html lang="de-CH">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Power BI Schulungshandbuch für HR</title>
  <style>
    :root {
      color-scheme: light;
      --accent: #1f6feb;
      --text: #0f172a;
      --muted: #475569;
      --bg: #f8fafc;
      --card: #ffffff;
      --border: #e2e8f0;
      --code: #0b1020;
    }
    body {
      margin: 0;
      font-family: "Segoe UI", system-ui, -apple-system, sans-serif;
      color: var(--text);
      background: var(--bg);
      line-height: 1.6;
    }
    header {
      background: linear-gradient(120deg, #e0f2fe 0%, #eef2ff 100%);
      padding: 40px 24px 24px;
      border-bottom: 1px solid var(--border);
    }
    header h1 {
      margin: 0 0 8px 0;
      font-size: 2.2rem;
    }
    header p {
      margin: 4px 0;
      color: var(--muted);
    }
    main {
      max-width: 980px;
      margin: 0 auto;
      padding: 24px;
    }
    section {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 20px;
      box-shadow: 0 4px 16px rgba(15, 23, 42, 0.04);
    }
    h2 {
      margin-top: 0;
      color: #111827;
      border-bottom: 2px solid var(--border);
      padding-bottom: 6px;
    }
    h3 {
      margin-bottom: 6px;
      color: #1e293b;
    }
    .badge {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 999px;
      font-size: 0.85rem;
      background: #e0f2fe;
      color: #0369a1;
      margin-left: 8px;
    }
    ul, ol {
      margin: 8px 0 16px 24px;
    }
    .callout {
      border-left: 4px solid var(--accent);
      background: #eef2ff;
      padding: 12px 16px;
      border-radius: 8px;
      margin: 12px 0;
      color: #1e293b;
    }
    .warning {
      border-left-color: #f97316;
      background: #fff7ed;
    }
    pre {
      background: #0b1020;
      color: #e2e8f0;
      padding: 16px;
      border-radius: 10px;
      overflow-x: auto;
    }
    code {
      font-family: "Consolas", "Courier New", monospace;
    }
    figure {
      margin: 0;
      padding: 0;
    }
    figcaption {
      color: var(--muted);
      font-size: 0.9rem;
      margin-top: 8px;
    }
    .grid-two {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
    }
    .kpi-list li {
      margin-bottom: 4px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Power BI Schulungshandbuch für HR</h1>
    <p>Word-Version: Nicht im Repo enthalten (Binary-Dateien werden beim PR-Erstellen nicht unterstützt).</p>
    <p>Version: HTML-Ausgabe mit erweiterten Erklärungen, Checklisten und Beispielen.</p>
  </header>

  <main>
    <section>
      <h2>Überblick</h2>
      <div class="grid-two">
        <div>
          <h3>Zielgruppe</h3>
          <ul>
            <li>3–4 HR-Mitarbeiterinnen (Schweiz)</li>
            <li>Excel-Basis + SVERWEIS</li>
            <li>Technikaffinität 5–6/10</li>
            <li>Keine Power BI Vorkenntnisse</li>
          </ul>
        </div>
        <div>
          <h3>Zielgruppen der Reports</h3>
          <ul>
            <li>Geschäftsleitung</li>
            <li>Verwaltungsrat</li>
            <li>Finanzbuchhaltung</li>
            <li>Abteilungsleiter</li>
          </ul>
        </div>
      </div>

      <h3>Datenquellen</h3>
      <ul>
        <li>SAP HCM/HRM (Infotypen PA0001, PA0002, PA0008, PA2001)</li>
        <li>Rexx HR-System (Stellenplan, Pulsumfrage, MA-Zufriedenheit)</li>
        <li>Excel/CSV (Kununu-Score, Refline/Time-to-hire)</li>
      </ul>

      <h3>KPIs</h3>
      <ul class="kpi-list">
        <li>Headcount/FTE (monatlich)</li>
        <li>Fluktuation (monatlich)</li>
        <li>Krankenquote gesamt + ohne Langzeitkrankheiten &gt;30 Tage (Quartal)</li>
        <li>Überstunden (Quartal)</li>
        <li>Produktivstunden (wöchentlich)</li>
        <li>Ferientage/GLZ-Saldi (jährlich)</li>
        <li>Stellenplan Soll vs Ist (monatlich, Rexx)</li>
        <li>Lohnkosten (monatlich)</li>
        <li>Time to hire (Quartal)</li>
        <li>Kununu Score (monatlich)</li>
        <li>Pulsumfrage (Quartal, Rexx)</li>
        <li>MA-Zufriedenheitsumfrage (jährlich, Rexx)</li>
      </ul>

      <figure>
        <svg width="100%" height="240" viewBox="0 0 900 240" role="img" aria-label="Datenfluss von Quellen zu Power BI und Reports">
          <defs>
            <linearGradient id="box" x1="0" x2="1">
              <stop offset="0%" stop-color="#e0f2fe"/>
              <stop offset="100%" stop-color="#eef2ff"/>
            </linearGradient>
          </defs>
          <rect x="20" y="30" width="220" height="60" rx="12" fill="url(#box)" stroke="#94a3b8" />
          <text x="130" y="65" text-anchor="middle" font-size="14" fill="#0f172a">SAP HCM/HRM</text>

          <rect x="20" y="120" width="220" height="60" rx="12" fill="url(#box)" stroke="#94a3b8" />
          <text x="130" y="155" text-anchor="middle" font-size="14" fill="#0f172a">Rexx HR-System</text>

          <rect x="20" y="210" width="220" height="60" rx="12" fill="url(#box)" stroke="#94a3b8" />
          <text x="130" y="245" text-anchor="middle" font-size="14" fill="#0f172a">Excel/CSV</text>

          <rect x="330" y="100" width="220" height="80" rx="14" fill="#1f6feb" opacity="0.12" stroke="#1f6feb" />
          <text x="440" y="145" text-anchor="middle" font-size="16" fill="#1f6feb">Power BI Desktop</text>

          <rect x="650" y="70" width="220" height="120" rx="14" fill="#ecfeff" stroke="#0ea5e9" />
          <text x="760" y="120" text-anchor="middle" font-size="14" fill="#0f172a">Berichte &amp; Dashboards</text>
          <text x="760" y="145" text-anchor="middle" font-size="12" fill="#475569">GL · VR · Finanzen · Abteilungen</text>

          <line x1="240" y1="60" x2="330" y2="120" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)" />
          <line x1="240" y1="150" x2="330" y2="140" stroke="#64748b" stroke-width="2" />
          <line x1="240" y1="240" x2="330" y2="160" stroke="#64748b" stroke-width="2" />
          <line x1="550" y1="140" x2="650" y2="130" stroke="#64748b" stroke-width="2" />

          <defs>
            <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
              <path d="M0,0 L9,3 L0,6 Z" fill="#64748b" />
            </marker>
          </defs>
        </svg>
        <figcaption>Grafik: Datenfluss von HR-Quellen in Power BI bis zu den Zielgruppen-Reports.</figcaption>
      </figure>
    </section>

    <section>
      <h2>1. Grundlagen &amp; Datenimport <span class="badge">Modul 1</span></h2>
      <h3>1.1 Installation &amp; erster Start</h3>
      <ol>
        <li>Gehe auf https://powerbi.microsoft.com/de-de/desktop/ und lade Power BI Desktop herunter.</li>
        <li>Installiere die Anwendung mit den Standardoptionen (Weiter → Installieren → Fertigstellen).</li>
        <li>Starte Power BI Desktop und wähle „Leerer Bericht“.</li>
        <li>Speichere die Datei als <code>HR-Reporting.pbix</code> in einem Projektordner.</li>
      </ol>
      <div class="callout">Tipp: Lege eine Ordnerstruktur an: <code>01_Rohdaten</code>, <code>02_Modelle</code>, <code>03_Exporte</code>.</div>

      <h3>1.2 Oberfläche kennenlernen</h3>
      <ol>
        <li>Wechsle links zwischen Berichts-, Daten- und Modellansicht.</li>
        <li>Suche das Menüband (oben), Visualisierungen (rechts) und den Felderbereich (rechts).</li>
        <li>Öffne den Filterbereich, um Filter auf Visual-, Seiten- und Berichtsebene zu sehen.</li>
      </ol>

      <h3>1.3 Excel &amp; CSV importieren</h3>
      <ol>
        <li>Start → Daten abrufen → Excel/CSV.</li>
        <li>Im Navigator nur relevante Tabellen auswählen.</li>
        <li>Encoding auf UTF-8 setzen, wenn Umlaute falsch angezeigt werden.</li>
      </ol>
      <div class="callout warning">Warnung: Achte auf das Dezimaltrennzeichen (Punkt/Komma). Setze ggf. das Gebietsschema auf Schweiz.</div>
    </section>

    <section>
      <h2>2. Power Query Editor <span class="badge">Modul 2</span></h2>
      <h3>2.1 Datentypen &amp; Struktur</h3>
      <ol>
        <li>Transformieren → Erste Zeile als Überschriften.</li>
        <li>Datentypen auf Datum, Text oder Zahl setzen.</li>
        <li>Überflüssige Spalten entfernen, relevante Spalten behalten.</li>
      </ol>

      <h3>2.2 Filter &amp; Bereinigung</h3>
      <ol>
        <li>Filter für aktive Mitarbeitende setzen.</li>
        <li>Nullwerte ersetzen (z. B. 0 für fehlende Überstunden).</li>
        <li>Codes in Klartext umwandeln (z. B. A → Aktiv).</li>
      </ol>
    </section>

    <section>
      <h2>3. Datenmodell <span class="badge">Modul 3</span></h2>
      <h3>3.1 Beziehungen erstellen</h3>
      <ol>
        <li>PERNR als Schlüssel zwischen SAP-Tabellen nutzen.</li>
        <li>Datumsbeziehungen über eine zentrale Datumstabelle herstellen.</li>
        <li>Kreuzfilterrichtung auf „Einweg“ setzen.</li>
      </ol>

      <h3>3.2 Datumstabelle (DAX)</h3>
      <pre><code>Datum = ADDCOLUMNS(
    CALENDAR(DATE(2020,1,1), TODAY()),
    "Jahr", YEAR([Date]),
    "Monat", MONTH([Date]),
    "MonatName", FORMAT([Date],"MMMM"),
    "Quartal", "Q" &amp; QUARTER([Date]),
    "KW", WEEKNUM([Date])
)</code></pre>
    </section>

    <section>
      <h2>4. DAX Measures <span class="badge">Modul 4</span></h2>
      <h3>4.1 Basis-Measures</h3>
      <pre><code>Headcount = COUNTROWS(Mitarbeiter)
FTE = SUMX(Mitarbeiter, Mitarbeiter[Beschäftigungsgrad]/100)
Krankenquote = DIVIDE([Krankheitstage], [Sollarbeitstage], 0)</code></pre>

      <h3>4.2 Zeitintelligenz</h3>
      <pre><code>Headcount_VJ = CALCULATE([Headcount], SAMEPERIODLASTYEAR(Datum[Date]))
Headcount_YTD = TOTALYTD([Headcount], Datum[Date])</code></pre>
    </section>

    <section>
      <h2>5. Visualisierung &amp; Dashboard <span class="badge">Module 5–6</span></h2>
      <h3>5.1 Visuals gezielt einsetzen</h3>
      <ul>
        <li>Karten für KPI-Summen (Headcount, Fluktuation)</li>
        <li>Liniendiagramm für Trendverläufe</li>
        <li>Matrix für Detailansichten mit Drill-down</li>
      </ul>

      <h3>5.2 Dashboard-Layout</h3>
      <ol>
        <li>Wichtigste KPIs oben links platzieren (F-Muster).</li>
        <li>Maximal 6–8 Visuals pro Seite.</li>
        <li>Farben konsistent mit der Firmen-CI.</li>
      </ol>
    </section>

    <section>
      <h2>6. Veröffentlichen &amp; Teilen <span class="badge">Modul 7</span></h2>
      <ol>
        <li>Datei → Veröffentlichen → Arbeitsbereich wählen.</li>
        <li>Dashboard-Visuals anheften.</li>
        <li>Geplante Aktualisierung einrichten (mit Gateway für lokale Daten).</li>
        <li>Row-Level Security für Abteilungsleiter einrichten.</li>
      </ol>
      <div class="callout">Tipp: Teste RLS immer im Service über „Als Rolle anzeigen“.</div>
    </section>

    <section>
      <h2>7. Troubleshooting &amp; Checklisten <span class="badge">Modul 8–9</span></h2>
      <h3>7.1 Häufige Fehler</h3>
      <ul>
        <li>Encoding-Probleme → UTF-8 auswählen</li>
        <li>Datum als Text → Datentyp mit Gebietsschema Schweiz</li>
        <li>Division durch Null → <code>DIVIDE()</code> verwenden</li>
      </ul>

      <h3>7.2 Checkliste neuer Report</h3>
      <ol>
        <li>Datenquellen klären und Exporte konsolidieren.</li>
        <li>Power Query Bereinigung durchführen.</li>
        <li>Datenmodell und Datumstabelle sauber anlegen.</li>
        <li>Measures erstellen und formatieren.</li>
        <li>Dashboard bauen, testen, veröffentlichen.</li>
      </ol>
    </section>
  </main>
</body>
</html>
